--query to verify the cruise and cruise leg information was copied successfully using the DEEP_COPY_CRUISE_SP procedure:
select v_orig.cruise_name orig_cruise_name, v_copy.cruise_name copy_cruise_name, v_orig.leg_name orig_leg_name, v_copy.leg_name copy_leg_name,
(CASE WHEN


 (v_orig.CRUISE_NOTES =  v_copy.CRUISE_NOTES OR (v_orig.CRUISE_NOTES IS NULL AND v_copy.CRUISE_NOTES IS NULL))
 AND (dbms_lob.substr( v_orig.CRUISE_DESC, 4000, 1 ) =  dbms_lob.substr( v_copy.CRUISE_DESC, 4000, 1 ) OR (v_orig.CRUISE_DESC IS NULL AND v_copy.CRUISE_DESC IS NULL))
 AND (v_orig.OBJ_BASED_METRICS =  v_copy.OBJ_BASED_METRICS OR (v_orig.OBJ_BASED_METRICS IS NULL AND v_copy.OBJ_BASED_METRICS IS NULL))
 AND (v_orig.SCI_CENTER_DIV_ID =  v_copy.SCI_CENTER_DIV_ID OR (v_orig.SCI_CENTER_DIV_ID IS NULL AND v_copy.SCI_CENTER_DIV_ID IS NULL))
 AND (v_orig.SCI_CENTER_DIV_CODE =  v_copy.SCI_CENTER_DIV_CODE OR (v_orig.SCI_CENTER_DIV_CODE IS NULL AND v_copy.SCI_CENTER_DIV_CODE IS NULL))
 AND (v_orig.SCI_CENTER_DIV_NAME =  v_copy.SCI_CENTER_DIV_NAME OR (v_orig.SCI_CENTER_DIV_NAME IS NULL AND v_copy.SCI_CENTER_DIV_NAME IS NULL))
 AND (v_orig.SCI_CENTER_DIV_DESC =  v_copy.SCI_CENTER_DIV_DESC OR (v_orig.SCI_CENTER_DIV_DESC IS NULL AND v_copy.SCI_CENTER_DIV_DESC IS NULL))
 AND (v_orig.SCI_CENTER_ID =  v_copy.SCI_CENTER_ID OR (v_orig.SCI_CENTER_ID IS NULL AND v_copy.SCI_CENTER_ID IS NULL))
 AND (v_orig.SCI_CENTER_NAME =  v_copy.SCI_CENTER_NAME OR (v_orig.SCI_CENTER_NAME IS NULL AND v_copy.SCI_CENTER_NAME IS NULL))
 AND (v_orig.SCI_CENTER_DESC =  v_copy.SCI_CENTER_DESC OR (v_orig.SCI_CENTER_DESC IS NULL AND v_copy.SCI_CENTER_DESC IS NULL))
 AND (v_orig.STD_SVY_NAME_ID =  v_copy.STD_SVY_NAME_ID OR (v_orig.STD_SVY_NAME_ID IS NULL AND v_copy.STD_SVY_NAME_ID IS NULL))
 AND (v_orig.STD_SVY_NAME =  v_copy.STD_SVY_NAME OR (v_orig.STD_SVY_NAME IS NULL AND v_copy.STD_SVY_NAME IS NULL))
 AND (v_orig.STD_SVY_DESC =  v_copy.STD_SVY_DESC OR (v_orig.STD_SVY_DESC IS NULL AND v_copy.STD_SVY_DESC IS NULL))
 AND (v_orig.SVY_FREQ_ID =  v_copy.SVY_FREQ_ID OR (v_orig.SVY_FREQ_ID IS NULL AND v_copy.SVY_FREQ_ID IS NULL))
 AND (v_orig.SVY_FREQ_NAME =  v_copy.SVY_FREQ_NAME OR (v_orig.SVY_FREQ_NAME IS NULL AND v_copy.SVY_FREQ_NAME IS NULL))
 AND (v_orig.SVY_FREQ_DESC =  v_copy.SVY_FREQ_DESC OR (v_orig.SVY_FREQ_DESC IS NULL AND v_copy.SVY_FREQ_DESC IS NULL))
 AND (v_orig.STD_SVY_NAME_OTH =  v_copy.STD_SVY_NAME_OTH OR (v_orig.STD_SVY_NAME_OTH IS NULL AND v_copy.STD_SVY_NAME_OTH IS NULL))
 AND (v_orig.STD_SVY_NAME_VAL =  v_copy.STD_SVY_NAME_VAL OR (v_orig.STD_SVY_NAME_VAL IS NULL AND v_copy.STD_SVY_NAME_VAL IS NULL))
 AND (v_orig.SVY_TYPE_ID =  v_copy.SVY_TYPE_ID OR (v_orig.SVY_TYPE_ID IS NULL AND v_copy.SVY_TYPE_ID IS NULL))
 AND (v_orig.SVY_TYPE_NAME =  v_copy.SVY_TYPE_NAME OR (v_orig.SVY_TYPE_NAME IS NULL AND v_copy.SVY_TYPE_NAME IS NULL))
 AND (v_orig.SVY_TYPE_DESC =  v_copy.SVY_TYPE_DESC OR (v_orig.SVY_TYPE_DESC IS NULL AND v_copy.SVY_TYPE_DESC IS NULL))
 AND (v_orig.CRUISE_URL =  v_copy.CRUISE_URL OR (v_orig.CRUISE_URL IS NULL AND v_copy.CRUISE_URL IS NULL))
 AND (v_orig.CRUISE_CONT_EMAIL =  v_copy.CRUISE_CONT_EMAIL OR (v_orig.CRUISE_CONT_EMAIL IS NULL AND v_copy.CRUISE_CONT_EMAIL IS NULL))
 AND (v_orig.NUM_LEGS =  v_copy.NUM_LEGS OR (v_orig.NUM_LEGS IS NULL AND v_copy.NUM_LEGS IS NULL))
 AND (v_orig.CRUISE_START_DATE =  v_copy.CRUISE_START_DATE OR (v_orig.CRUISE_START_DATE IS NULL AND v_copy.CRUISE_START_DATE IS NULL))
 AND (v_orig.FORMAT_CRUISE_START_DATE =  v_copy.FORMAT_CRUISE_START_DATE OR (v_orig.FORMAT_CRUISE_START_DATE IS NULL AND v_copy.FORMAT_CRUISE_START_DATE IS NULL))
 AND (v_orig.CRUISE_END_DATE =  v_copy.CRUISE_END_DATE OR (v_orig.CRUISE_END_DATE IS NULL AND v_copy.CRUISE_END_DATE IS NULL))
 AND (v_orig.FORMAT_CRUISE_END_DATE =  v_copy.FORMAT_CRUISE_END_DATE OR (v_orig.FORMAT_CRUISE_END_DATE IS NULL AND v_copy.FORMAT_CRUISE_END_DATE IS NULL))
 AND (v_orig.CRUISE_DAS =  v_copy.CRUISE_DAS OR (v_orig.CRUISE_DAS IS NULL AND v_copy.CRUISE_DAS IS NULL))
 AND (v_orig.CRUISE_YEAR =  v_copy.CRUISE_YEAR OR (v_orig.CRUISE_YEAR IS NULL AND v_copy.CRUISE_YEAR IS NULL))
 AND (v_orig.CRUISE_FISC_YEAR =  v_copy.CRUISE_FISC_YEAR OR (v_orig.CRUISE_FISC_YEAR IS NULL AND v_copy.CRUISE_FISC_YEAR IS NULL))
-- AND (v_orig.LEG_NAME_RC_LIST =  v_copy.LEG_NAME_RC_LIST OR (v_orig.LEG_NAME_RC_LIST IS NULL AND v_copy.LEG_NAME_RC_LIST IS NULL))
-- AND (v_orig.LEG_NAME_DATES_RC_LIST =  v_copy.LEG_NAME_DATES_RC_LIST OR (v_orig.LEG_NAME_DATES_RC_LIST IS NULL AND v_copy.LEG_NAME_DATES_RC_LIST IS NULL))
 AND (v_orig.NUM_SPP_ESA =  v_copy.NUM_SPP_ESA OR (v_orig.NUM_SPP_ESA IS NULL AND v_copy.NUM_SPP_ESA IS NULL))
 AND (v_orig.SPP_ESA_NAME_RC_LIST =  v_copy.SPP_ESA_NAME_RC_LIST OR (v_orig.SPP_ESA_NAME_RC_LIST IS NULL AND v_copy.SPP_ESA_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_SPP_FSSI =  v_copy.NUM_SPP_FSSI OR (v_orig.NUM_SPP_FSSI IS NULL AND v_copy.NUM_SPP_FSSI IS NULL))
 AND (v_orig.SPP_FSSI_NAME_RC_LIST =  v_copy.SPP_FSSI_NAME_RC_LIST OR (v_orig.SPP_FSSI_NAME_RC_LIST IS NULL AND v_copy.SPP_FSSI_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_SPP_MMPA =  v_copy.NUM_SPP_MMPA OR (v_orig.NUM_SPP_MMPA IS NULL AND v_copy.NUM_SPP_MMPA IS NULL))
 AND (v_orig.SPP_MMPA_NAME_RC_LIST =  v_copy.SPP_MMPA_NAME_RC_LIST OR (v_orig.SPP_MMPA_NAME_RC_LIST IS NULL AND v_copy.SPP_MMPA_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_PRIM_SVY_CATS =  v_copy.NUM_PRIM_SVY_CATS OR (v_orig.NUM_PRIM_SVY_CATS IS NULL AND v_copy.NUM_PRIM_SVY_CATS IS NULL))
 AND (v_orig.PRIM_SVY_CAT_NAME_RC_LIST =  v_copy.PRIM_SVY_CAT_NAME_RC_LIST OR (v_orig.PRIM_SVY_CAT_NAME_RC_LIST IS NULL AND v_copy.PRIM_SVY_CAT_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_SEC_SVY_CATS =  v_copy.NUM_SEC_SVY_CATS OR (v_orig.NUM_SEC_SVY_CATS IS NULL AND v_copy.NUM_SEC_SVY_CATS IS NULL))
 AND (v_orig.SEC_SVY_CAT_NAME_RC_LIST =  v_copy.SEC_SVY_CAT_NAME_RC_LIST OR (v_orig.SEC_SVY_CAT_NAME_RC_LIST IS NULL AND v_copy.SEC_SVY_CAT_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_EXP_SPP =  v_copy.NUM_EXP_SPP OR (v_orig.NUM_EXP_SPP IS NULL AND v_copy.NUM_EXP_SPP IS NULL))
 AND (v_orig.EXP_SPP_NAME_RC_LIST =  v_copy.EXP_SPP_NAME_RC_LIST OR (v_orig.EXP_SPP_NAME_RC_LIST IS NULL AND v_copy.EXP_SPP_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_SPP_OTH =  v_copy.NUM_SPP_OTH OR (v_orig.NUM_SPP_OTH IS NULL AND v_copy.NUM_SPP_OTH IS NULL))
 AND (v_orig.OTH_SPP_CNAME_RC_LIST =  v_copy.OTH_SPP_CNAME_RC_LIST OR (v_orig.OTH_SPP_CNAME_RC_LIST IS NULL AND v_copy.OTH_SPP_CNAME_RC_LIST IS NULL))
 AND (v_orig.OTH_SPP_SNAME_RC_LIST =  v_copy.OTH_SPP_SNAME_RC_LIST OR (v_orig.OTH_SPP_SNAME_RC_LIST IS NULL AND v_copy.OTH_SPP_SNAME_RC_LIST IS NULL))
 --AND (v_orig.CRUISE_LEG_ID =  v_copy.CRUISE_LEG_ID OR (v_orig.CRUISE_LEG_ID IS NULL AND v_copy.CRUISE_LEG_ID IS NULL))
 AND (v_orig.LEG_NAME || ' (copy)' =  v_copy.LEG_NAME OR (v_orig.LEG_NAME IS NULL AND v_copy.LEG_NAME IS NULL))
 AND (v_orig.LEG_START_DATE =  v_copy.LEG_START_DATE OR (v_orig.LEG_START_DATE IS NULL AND v_copy.LEG_START_DATE IS NULL))
 AND (v_orig.FORMAT_LEG_START_DATE =  v_copy.FORMAT_LEG_START_DATE OR (v_orig.FORMAT_LEG_START_DATE IS NULL AND v_copy.FORMAT_LEG_START_DATE IS NULL))
 AND (v_orig.LEG_END_DATE =  v_copy.LEG_END_DATE OR (v_orig.LEG_END_DATE IS NULL AND v_copy.LEG_END_DATE IS NULL))
 AND (v_orig.FORMAT_LEG_END_DATE =  v_copy.FORMAT_LEG_END_DATE OR (v_orig.FORMAT_LEG_END_DATE IS NULL AND v_copy.FORMAT_LEG_END_DATE IS NULL))
 AND (v_orig.LEG_DAS =  v_copy.LEG_DAS OR (v_orig.LEG_DAS IS NULL AND v_copy.LEG_DAS IS NULL))
 AND (v_orig.LEG_YEAR =  v_copy.LEG_YEAR OR (v_orig.LEG_YEAR IS NULL AND v_copy.LEG_YEAR IS NULL))
 AND (v_orig.LEG_FISC_YEAR =  v_copy.LEG_FISC_YEAR OR (v_orig.LEG_FISC_YEAR IS NULL AND v_copy.LEG_FISC_YEAR IS NULL))
 AND (v_orig.LEG_DESC =  v_copy.LEG_DESC OR (v_orig.LEG_DESC IS NULL AND v_copy.LEG_DESC IS NULL))
 AND (v_orig.VESSEL_ID =  v_copy.VESSEL_ID OR (v_orig.VESSEL_ID IS NULL AND v_copy.VESSEL_ID IS NULL))
 AND (v_orig.VESSEL_NAME =  v_copy.VESSEL_NAME OR (v_orig.VESSEL_NAME IS NULL AND v_copy.VESSEL_NAME IS NULL))
 AND (v_orig.VESSEL_DESC =  v_copy.VESSEL_DESC OR (v_orig.VESSEL_DESC IS NULL AND v_copy.VESSEL_DESC IS NULL))
 AND (v_orig.PLAT_TYPE_ID =  v_copy.PLAT_TYPE_ID OR (v_orig.PLAT_TYPE_ID IS NULL AND v_copy.PLAT_TYPE_ID IS NULL))
 AND (v_orig.PLAT_TYPE_NAME =  v_copy.PLAT_TYPE_NAME OR (v_orig.PLAT_TYPE_NAME IS NULL AND v_copy.PLAT_TYPE_NAME IS NULL))
 AND (v_orig.PLAT_TYPE_DESC =  v_copy.PLAT_TYPE_DESC OR (v_orig.PLAT_TYPE_DESC IS NULL AND v_copy.PLAT_TYPE_DESC IS NULL))
 AND (v_orig.NUM_REG_ECOSYSTEMS =  v_copy.NUM_REG_ECOSYSTEMS OR (v_orig.NUM_REG_ECOSYSTEMS IS NULL AND v_copy.NUM_REG_ECOSYSTEMS IS NULL))
 AND (v_orig.REG_ECOSYSTEM_RC_LIST =  v_copy.REG_ECOSYSTEM_RC_LIST OR (v_orig.REG_ECOSYSTEM_RC_LIST IS NULL AND v_copy.REG_ECOSYSTEM_RC_LIST IS NULL))
 AND (v_orig.NUM_GEAR =  v_copy.NUM_GEAR OR (v_orig.NUM_GEAR IS NULL AND v_copy.NUM_GEAR IS NULL))
 AND (v_orig.GEAR_NAME_RC_LIST =  v_copy.GEAR_NAME_RC_LIST OR (v_orig.GEAR_NAME_RC_LIST IS NULL AND v_copy.GEAR_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_REGIONS =  v_copy.NUM_REGIONS OR (v_orig.NUM_REGIONS IS NULL AND v_copy.NUM_REGIONS IS NULL))
 AND (v_orig.REGION_CODE_RC_LIST =  v_copy.REGION_CODE_RC_LIST OR (v_orig.REGION_CODE_RC_LIST IS NULL AND v_copy.REGION_CODE_RC_LIST IS NULL))
 AND (v_orig.REGION_NAME_RC_LIST =  v_copy.REGION_NAME_RC_LIST OR (v_orig.REGION_NAME_RC_LIST IS NULL AND v_copy.REGION_NAME_RC_LIST IS NULL))
 AND (v_orig.NUM_LEG_ALIASES =  v_copy.NUM_LEG_ALIASES OR (v_orig.NUM_LEG_ALIASES IS NULL AND v_copy.NUM_LEG_ALIASES IS NULL))
 AND (REPLACE(v_orig.LEG_ALIAS_RC_LIST, chr(10), ' (copy)'||chr(10))||' (copy)' =  v_copy.LEG_ALIAS_RC_LIST OR (v_orig.LEG_ALIAS_RC_LIST IS NULL AND v_copy.LEG_ALIAS_RC_LIST IS NULL))

THEN 'Y' ELSE 'N' END) values_equal_yn

from CCD_CRUISE_LEG_DELIM_V v_orig
inner join CCD_CRUISE_LEG_DELIM_V v_copy
ON
v_orig.cruise_name||' (copy)' = v_copy.cruise_name
AND
(v_orig.leg_name||' (copy)' = v_copy.leg_name OR (v_orig.leg_name IS NULL AND v_copy.leg_name IS NULL))

where v_orig.CRUISE_NAME = :CRUISE_NAME
order by v_orig.cruise_name,
v_orig.leg_name;
