APEX Application

_ DVM error annotation page
_ DVM report page
_ Cruise database data management page
_ Cruise database report pages
	_ cruise summary per year
	_ activity summary per cruise (list page with all cruise activities) - allow filtering by cruise
	_ allow searching by activity or data product

_ allow uploading/viewing of cruise instructions
_ Phase 2-3: spatial components, bounding box, search for research activities
_ bounding box -> range for individual sites
_ LDAP
	All users have view-only access, specific people can edit
VPASS integration? (allocation) making the actual ship request - Nori will get me access to pull data
FINSS - https://www.st.nmfs.noaa.gov/finss/si/siMain.jsp

Database Update:

_ Add Operational Information
	cruise - description, start port, end port, chief scientist, DOI - X View to get min/max dates to pull full cruise date range
		X cruise legs (e.g. HA1201 LEG III)
		X cruise leg region(s)
		X regions (store polygon, coordinates, etc.)
			_ islands (store polygon, coordinates, etc.)


	science party - name, role, affiliation
	X data sets - specific instances on specific cruises that references the data set types record
		X data set types (e.g. MOUSS video, CTD, water samples, coral belt, fish REA, etc.) - pull suitable categories from NCEI/NMFS
			X data sets collected (description, data set type, etc.), DOI, link to data set, link to documentation, link to NMFS metadata, POC info, etc. - link to application for accessing the data directly (e.g. Reefbox)
					X unique key constraint on data set type and cruise/cruise leg

				_ data products (e.g. biomass, richness, stereo video, coral cover, etc.) - Unique key constraint on data set and data product type
				_ data set products (date available, access url, etc.)


				_ cruise participants (phase 2)
					_ participant permissions
					_ participant checklist (requirements including how often/timeframe)
				_ cruise chief scientist


				X data set status (e.g. not collected, collected, processed, data products available, publicly accessible, archived)
	track pre- and post-cruise activities


	X create a function that can easily be used by a given external schema to match a given cruise leg alias so it can be associated with a given cruise leg alias record (CRUISE_PKG.LEG_ALIAS_TO_CRUISE_LEG_ID)



Questions:





_ tabular form for the SOD data administrator to update the requirements for all cruise participants (TB, conduct, etc.) - allows the updating of multiple participants' information concurrently


_ add/edit cruise page should also contain a tabular form with one record by default with the ability to add multiple cruise legs at the same time

_ should we go with a more generic "Mission" database and each mission would essentially be a cruise and there would be a type field that would have values like NOAA Cruise, Nearshore Mission?


_ auditing fields and history package on all operational data tables

X re-define views on CCD DB

X grant statements for CEN_CTD schema

Misc:
	I could give a piece of project to Kimberly, she will generate GIS layers and populate data model
	test best practices for data model
	shape files from cruise activities -> standardizing these data products
	point locations in DB for surveys
	how to define working areas?
	QC the region polygons for summary locations
	historic sites -> proximity (e.g. CTD stations)
		CTD historic sites could be indicated by text column for historic/not historic in the short term
	participant list is in phase 2
		Participants could be pulled from Peachy (non-confidential)
		Ship profile for people - non-public info: TB info, MAC address, food restrictions, IT security awareness
	associate data sets at the program level
	chief scientist and POC for data defined per cruise


External User/Group management (request if the CEN_CRUISE schema can be granted select access to a non-confidential view that has user (first, last, email) and group information (div/prog) that can be used to
	_ look into modifying the auth app views so that they use these tables for authentication/authorization so these don't need to be maintained separately.  Also need to assign admin privileges for specific SOD staff to be able to change anything in the DB


DVM QC Criteria:
_ same ship cannot have concurrent cruises
_ missing field values
_ date criteria (start/end dates, etc.)
_ regex for the cruise name to make sure that the cruise name (e.g. SE-15-01) is in the same federal fiscal year as the departure or end date


_ RSS feed functionality - subscribe to a cruise leg's data set or type of data set/stream for all updates or just when ready for download

_ utilize roles to grant the set of object permissions necessary to integrate the CCD into a given data set.  But this is problematic because roles are not enabled by default when executing PL/SQL code.  This needs more research




VPASS
	Logged in as a PI.  Could create a new ship request but couldn't see anything in the instructions to allow importing of ship requset data.
	Can pull reports and filter by FY and project name (e.g. PIFSC) but there is no option to download the approved ship requests only so they can be exported to the CCD.  You can also sort as well but the data for exporting cruise information is not readily accessible.
		Closest thing to being able to import a record seems to be copying an existing record in the system
	Can export ship time requests as a .xlsx
		VC Status seems to indicate if the project was approved or not (e.g. Certified by OU VC & Submitted to LO REP)
		X look at fields to see which should be added to the Cruise/Leg tables (some of the fields displayed in the interface are not populated in the .xlsx export - e.g.  start date, end date, Org Unit 1, Piggyback Notes)
			Some fields are shown on the searching interface and not in the Excel sheet (e.g. VC Status) and vice versa (e.g. staging port, staging day, staging day from, destaging port, destaging day, )




FINSS (planning system and reporting system)
	Logged in
	Survey Instrance Reports:
		Can filter the PIFSC cruises and then export as CSV file.  The CSV file does not contain the cruise dates.  This does contain valuable information like Categories, Gear, Vessels, days at sea, survey name, number of legs, etc.
	Survey Instance Records:
		Can filter the PIFSC cruises but there is no option to export the data.  Cannot export the data from the Survey instance search but it does contain information like Cruise dates in the Survey Cruises column.  But there is no way to readily export the data and import it into the CCD.  The cruise information is concatenated into a single field but this field could be parsed if it was available electronically.  Only other option is to copy and paste the dynamic HTML and then parse it using other means (e.g. programmatically but this is not recommended because this import process will need to change each time the interface changes).  Perhaps we could request a data dump for the PIFSC projects annually/periodically?
		Can export KML (look into this more)



	Data elements:
		Legs (called cruises in FINSS) - Leg Start/End date, days at sea (calculated), Platform Type (LOV), Vessel(LOV), Regional Ecosystem(LOV), Gear(LOV), Project Name in VPASS, Standard Survey Name (LOV),
		Cruise (called survey instance in FINSS) - Center (LOV - should always be PIFSC), FY, Survey Frequency (LOV), Survey URL, Survey Contact Email, Primary survey category (LOV), Secondary Survey Category (LOV), Target Species - ESA (LOV), Target Species - MMPA (LOV), Target Species - FSSI (LOV), Target Species - Other Species (LOV), Expected Species Categories (LOV), Comments


	SQL code to calculate the numer of days at sea (document this and define in CEN_TOOLS_PKG or CRUISE_PKG pkg)
		ex: select TO_DATE('20-JUL-19', 'DD-MON-YY') - TO_DATE('06-JUL-19', 'DD-MON-YY') + 1 from dual;

	Phase 2
		Maybe allow preferences to be defined (e.g. ESD CRCP cruises automatically select the coral species of interest and then they can modify to streamline and provide templates





Ask Nori the intent of the CCD with respect to FINSS and VPASS - there is no import functionality so not sure how we would use the CCD other than to import the information from the other NOAA systems to populate the CCD.



_ rename package CCD_PKG instead of CRUISE_PKG


_ review the CTD app for features to implement (tooltips, downloads, etc.)
	_ tooltips (_page 230)

X default the sci center to PIFSC
X default the survey type to NMFS Survey


_ summary reports for the home page
	_ (broken down by division/program, survey name, ) total number of days at sea, total number of cruises, cruise legs

	_ dynamic reports?  Choose fields to group on and values to filter on (charts e.g. by region, regional ecosystems, target species, etc.)


	X highlight background of the specific regions to show the active forms so people know what is available in a given window.	(_ document best practice)


	X conditional QA on the standard survey name

** _ document that the fiscal year is a field in FINSS but this can be automatically determined by the associated leg dates


X reference table lists/form (build out examples)


X add leg regions



How to implement presets (e.g. gear preset, target species, etc.) and how to handle in the interface -
	either
		X a shuttle field (no reason to specify multiple values, should just be a picker field
		X or a interactive grid (not necessary since it's just a way to choose existing options)

X create a link back to the view/edit cruise page from the view/edit cruise leg page

X rename view/edit to view/update

X implement presets for cruise-level information


_ add information in the documentation and on the page to indicate that the yellow background indicates active forms that can be used to add/edit database records
_ implement a view extended information tab for viewing all information in summary for the given cruise or cruise leg
_ tool tips for preset classic reports

**_ need to maintain the relative order of the different cruise options?

X package function to take the nth value in the delimited list (can even specify the delimiter if you want) - defined in the CEN_UTILS.CEN_UTILS_PKG




_ populate DVM QC criteria for DB to determine when there are cases that should be reviewed
	_ implement the review/annotation system

_ tooltips on the tabs in each of the view/edit Forms
_



_ *****document the best practices in the interface (e.g. tooltips, tabbed navigation, presets, etc.)



_ document business rule for standard survey name other field (CCD_CRUISES.CTD_SURVEY_NAME_OTH) and how the STD_SURVEY_NAME_ID fields should be mutually exclusive (one or the other with precedence to foreign key)
	X implemented in Views
_ document business rule for CCD_CRUISE_SURVEY_CATS.PRIMARY_YN field and how it is implemented in the application (filtered into two categories based on flag)
	X implement in Views



**X fix FY 2099 problem with TC9905 (this was due to the two-digit year defaulting 99 to 2099 instead of 1999)
X view cruise legs interactive report/classic reports are in sync (3/25/20) including columns and comments

_ unsaved changes warning when leaving page without saving (e.g. edit cruise leg link)
X CCD_SVY_CAT_PRE_V delimited view and form/report



Reference tables:
X CCD_SVY_FREQ
X CCD_SVY_TYPES
X CCD_TGT_SPP_ESA
X CCD_TGT_SPP_FSSI
X CCD_TGT_SPP_MMPA
X CCD_SVY_CATS
X CCD_STD_SVY_NAMES
X CCD_SCI_CENTERS
X CCD_REGIONS
X CCD_REG_ECOSYSTEMS
X CCD_PLAT_TYPES
X CCD_GEAR
X CCD_VESSELS
X CCD_EXP_SPP_CATS

X action processed notification on simple reference table modular windows when insert/edit/update occurs


_ filtered lists functionality (many-to-many) _ change to checkbox instead of y/n select field
X ESA
X FSSI
X MMPA
X gear
X expected species categories
_ primary survey categories
_ secondary survey categories
X regional ecosystems
regions



X filtered lists functionality (one-to-many)
X Vessels
X standard survey names


X add cruise fields:
	X description
	X Org - PIFSC Division (child of CCD_SCI_CENTERS)
	X Objective Based Metrics


**_ need to figure out how to deal with the presets if the selected value is not included in the shuttle field (add it to shuttle field?? - yes)


_ copy cruises and cruise legs
	X figure out how to copy the other species and leg aliases into the pending other species records:
	X cruise
	X leg
	_ cruise (deep copy)
		X handle the leg alias names by adding (copy) at the end of them
		X tooltip for the Deep Copy button so it is clear what this button does (warn about unsaved changes and that the saved changes are the ones that will be copied, unsaved changes will not be included)
		_ confirm dialog for the deep copy action
		use cases:
			X cruise (copy) already exists
			X cruise leg (copy) already exists
			X cruise leg alias name (copy) already exists
			X cruise only (no legs)
			X cruise only (no legs, no attributes)
			X cruise and legs (no cruise attributes)
			X cruise and legs (no leg attributes)
			X cruise and legs (cruise and leg attributes)
			X cruise doesn't exist
X switch leg attributes to use y/n checkboxes

_ implement deep copy in the interactive report (Page 210) as well

_ validation -
	X QA X QC legs can't have overlapping dates for the same cruise
	X QA X QC vessels can't have two concurrent legs
	X look for cruise/legs with names containing "(copy)" as this should not naturally occur in the data
	DAS/Cruise Length:
		X need to implement the secondary warning only if there is error:
		X warning where a cruise leg is more than 30 days?
		X warning where a cruise is more than 120 days?
		X cruise name validations
		X cruise name fiscal year and cruise fiscal year mismatch
	attribute validation
		X cruise without primary objective?
		X cruise leg without gear?


_ transactions in cruise and cruise leg processing

X add the reference table management page for science center divisions

X tooltips on the report pages for the filtering select fields

_ show validation errors in a different pane so it can be viewed and addressed
	_ link to APEX application pages with the corresponding IDs

_ add accessor DVM functions into CCD_CRUISE_PKG so it already has the CCD defined for it

_ execute the validation module each time a cruise record is saved or cruise leg is saved or deep copied

DVM
	_ implement the duplicate check that was developed for CTDs so we ensure that the error will exist on both sides

X update the QC Criteria and update/verify the test cases

X Update the business rules documentation



Implement the error report/annotation functionality in APEX


Implement the QA criteria

Testing documentation for QA criteria
